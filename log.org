:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
SMS Library Work Log
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
* Present Issues (todonow)
** [#B] plot stochastic coefficients at different rates to see if they are the same for diff sr
** [#B] ways to fix the stoc_ big crunch in the beginning:
*** something to do with sin/sinc tables or SinePhasSynth?
*** first check if area is consistent throughout different samples.
** changing the framerate in smsAnal makes deterministic component empty. huh?
*** Xavier suggests fund estimate is bad, so specify manually
*** resample after analysis (delete 3 out of 4 frames, concatenate stoc_wave)
** what is the difference between smsClean and the cleaning within smsAnal?
** what is calcCorr in tools?
* Pre-modifications: making analysis/plotting scripts
** DONE smsToYaml for importing into python
** TODO [#C] SWIG libsms wrappers for more convenient use in python
** DONE smsPlot.py for plotting smsData over a spectrogram of audio source.
* to clean:
** TODO check for memory leaks
   - [ ] sine/sinc tables
   - [ ] stuff in SmsInitAnalysis
*** TODO run memory leak detector
** TODO static variables in smsAnalysis
   - ComputeFrame
   - Spectrum
   - GetResidual
** TODO append sms_ to functions declared in sms.h
** DONE make a function for returning a string to the error
   - right now it is necessary to cop/paste a large block of code to do this
   - should replace the 'quit' function, and shouldn't exit by default
** DONE Globals:
*** DONE Tables
    - declare them in sms.h
    - allocate in SmsInit()
*** DONE pFrames/ppFrames
*** DONE FResidualPerc
        - defined in variousFuntions for now, as SmsInit() is always called.
** DONE SmsInit() should be a global init before anything
* Phase 1: Refactoring libsms for usage in real-time and release
** TODO [#A] - switch to FFTW3f for fft's
*** TODO Spectrum
    - determinate seems to be handled correctly
    - not stochastic; GetResidual is failing?
       - the crap in the residual is periodic
*** DONE start with SineSynthIFFT until it sounds right
**** questions about SineSynthIFFT()
     - [ ] why is nBins set to 8?
            - SincTab is also hardcoded for index = 0:8
     - [ ] why is the real component obtained by Mag * sin(theta)?
            - shouldn't it be cos(theta)?
**** periodic mess-ups in waveform:
      - 9 samples of zero
      - good samples: 44 ?
      - then, discontinuities (+infinite?) :
** TODO [#A] switch build scripts to scons 
   - [ ] get env. exporting/importing fixed
   - [ ] add install/uninstall functionality
** TODO [#B] convert from short to floating point data
   - will need this for pd anyway
   - everything is computed in float point, so why range from 0-16000   then?
   - [X] temp fix by making a const multiplier SHORT_TO_FLOAT
** TODO [#B] make sure pFStocGain is always set
     - zero if no stoc component, 1 if wave, or val if StocSpectrum
** TODO [#C] make example python scripts
** TODO [#C] move smsMod's stochostic gain adjusting to 
   - should stocGain be available for all stoc types?

** DONE [#B] convert README's to manpages.
   - [ ] update to fit new parameters
   - [ ] proofread** DONE [#B] update USAGE arguments to tell what different values do
** DONE [#A] should have the option to store residual in audio samples or STFT frames
*** TODO organize analParams to allow for options:
   - [X] sound samples
   - [X] filter approximation
   - [X] no stachostic component
*** TODO reorganization of SmsSynthesis
**** possible types
***** Deterministic only, OSC
***** Deterministic only, IFFT
***** Stoc only, IFFT
***** Stoc only, waveform
***** Stoc only, Approx
***** Deterministic + Stoc, IFFT
***** Deterministic + Stoc, IFFT + Approx
***** Deterministic + Stoc, IFFT + Waveform
***** Deterministic + Stoc, OSC + IFFT
***** Deterministic + Stoc, OSC + Approx
***** Deterministic + Stoc, OSC + Waveform

*** TODO Store Residual as STFT 
    - does imag need to be stored?
       - yes, it is cheaper to store/recall than to make a random one
    - [ ] allocate memory
    - [X] need sizeDFT in SMS_HEADER (i think)
    - should this be 2x hopsize because there is overlap of 50%?
    - [ ] store in stochAnalysis (probably should be somewhere else..)
    - [ ] make sure it is correctly stored in smsToYaml/smsPrint
*** TODO modify smsResample to concatenate stocWave data
    - [ ] will take adding iWaveSamples to SMS_DATA
** DONE [#A] make samplerate independant of analysis/synthesis
*** Investigating samplerate/framerate dependencies:
**** How is resample making the current SMS_DATA frame?

*** In order for real-time synthesis:
**** iLastSample in smsSynth must be replaced with 
        - iNumSamples will be a predefined buffer of samples to synthesis at one time,
          indepenent of synthesis blocksize
* Phase 2: building real-time pd externals for analysis/synthesis
